# Покроковий план виконання тестового завдання "Ліфт"

## Загальна структура проекту

### Технології та їх призначення:
- **PIXI.js** - бібліотека для 2D рендерингу через WebGL/Canvas. Використовується для відображення графіки (будинок, ліфт, люди)
- **Tween.js** - бібліотека для анімації. Використовується для плавного руху ліфта та людей
- **TypeScript** - типізована надбудова над JavaScript для кращої підтримки коду

---

## Етап 1: Налаштування проекту (День 1, 2-3 години)

### 1.1 Ініціалізація проекту
- [ ] Створити `package.json` з залежностями:
  - `pixi.js` - для рендерингу
  - `@tweenjs/tween.js` - для анімацій
  - `typescript` - для типізації
  - `ts-node` або `tsx` - для запуску TypeScript
  - `webpack` або `vite` - для збірки (рекомендую Vite - простіше)
- [ ] Налаштувати `tsconfig.json` з суворими типами
- [ ] Створити базову структуру папок:
  ```
  /src
    /models      - бізнес-логіка (ліфт, людина, будинок)
    /views       - PIXI компоненти (рендеринг)
    /controllers - логіка управління
    /config      - конфігурація
    /utils       - допоміжні функції
  /public
    index.html
  ```

**Пояснення PIXI.js на цьому етапі:**
- PIXI створює Application, який містить Stage (сцену) та Renderer (рендерер)
- Stage - це контейнер для всіх графічних об'єктів
- Renderer - відповідає за відображення на canvas

### 1.2 Створити базовий HTML та точку входу
- [ ] Створити `index.html` з canvas елементом
- [ ] Створити `src/main.ts` - точка входу
- [ ] Ініціалізувати PIXI Application
- [ ] Перевірити, що canvas відображається

**Git коміт:** "Initial project setup with PIXI.js"

---

## Етап 2: Моделі даних (День 1-2, 3-4 години)

### 2.1 Створити базові інтерфейси та типи
- [ ] `src/models/types.ts`:
  - `Direction` enum (UP, DOWN, IDLE)
  - `Person` interface (id, currentFloor, targetFloor, direction, isInElevator)
  - `ElevatorState` interface (currentFloor, direction, passengers, capacity)
  - `BuildingConfig` interface (floors, elevatorCapacity)

**Пояснення:** TypeScript інтерфейси допоможуть уникнути помилок та зробити код читабельнішим

### 2.2 Клас Person (Людина)
- [ ] `src/models/Person.ts`:
  - Властивості: id, currentFloor, targetFloor, direction
  - Метод `getDirection()` - визначає напрямок на основі currentFloor та targetFloor
  - Метод `isWaiting()` - перевіряє чи чекає на ліфт

**Пояснення:** Кожна людина - це об'єкт зі своїм станом та логікою

### 2.3 Клас Elevator (Ліфт)
- [ ] `src/models/Elevator.ts`:
  - Властивості: currentFloor, direction, passengers[], capacity
  - Метод `addPassenger(person)` - додати пасажира
  - Метод `removePassengers()` - видалити пасажирів на поточному поверсі
  - Метод `canPickUp(person)` - чи може підібрати людину (перевірка напрямку та місця)
  - Метод `getNextFloor()` - визначити наступний поверх (для оптимізації)

**Пояснення:** Ліфт - це state machine з логікою переміщення та завантаження

### 2.4 Клас Building (Будинок)
- [ ] `src/models/Building.ts`:
  - Властивості: floors, elevator, waitingPeople[] (по поверхах)
  - Метод `spawnPerson(floor)` - створити нову людину на поверсі
  - Метод `getWaitingPeople(floor, direction)` - отримати людей, що чекають

**Git коміт:** "Add core models: Person, Elevator, Building"

---

## Етап 3: Візуалізація з PIXI.js (День 2-3, 6-8 годин)

### 3.1 Базовий рендерер будинку
- [ ] `src/views/BuildingView.ts`:
  - Створити контейнер для будинку
  - Намалювати стіни та коридор (прямокутники через `Graphics`)
  - Намалювати поверхи (лінії або прямокутники)
  - Розмістити позначки поверхів (текст через `Text`)

**Пояснення PIXI.js Graphics:**
```typescript
const graphics = new PIXI.Graphics();
graphics.rect(x, y, width, height); // малює прямокутник
graphics.fill(0xFFFFFF); // заливка білим
container.addChild(graphics); // додаємо до сцени
```

### 3.2 Візуалізація ліфта
- [ ] `src/views/ElevatorView.ts`:
  - Створити контейнер для ліфта
  - Намалювати кабіну ліфта (прямокутник)
  - Намалювати двері (опціонально)
  - Метод `updatePosition(floor)` - оновити позицію на екрані

**Пояснення:** Контейнер ліфта буде переміщуватися по Y-осі залежно від поверху

### 3.3 Візуалізація людей
- [ ] `src/views/PersonView.ts`:
  - Створити контейнер для людини
  - Намалювати прямокутник (зелений для DOWN, синій для UP)
  - Додати текст з номером цільового поверху (`Text` об'єкт)
  - Метод `updateColor(direction)` - змінити колір
  - Метод `updatePosition(x, y)` - оновити позицію

**Пояснення PIXI.js Text:**
```typescript
const text = new PIXI.Text("5", { fontSize: 20, fill: 0x000000 });
text.anchor.set(0.5); // центрування тексту
container.addChild(text);
```

### 3.4 Інтеграція всіх view
- [ ] `src/views/GameView.ts`:
  - Об'єднати BuildingView, ElevatorView, PersonView
  - Налаштувати координати та масштаб
  - Метод `render()` - оновити всі view на основі моделей

**Git коміт:** "Add PIXI.js visualization for building, elevator and people"

---

## Етап 4: Анімація з Tween.js (День 3-4, 4-6 годин)

### 4.1 Анімація руху ліфта
- [ ] `src/controllers/ElevatorController.ts`:
  - Імпортувати Tween.js
  - Метод `moveToFloor(targetFloor)`:
    - Створити Tween для Y-координати ліфта
    - Розрахувати час анімації (1 поверх = 1 секунда)
    - Використати `onUpdate` для оновлення позиції
    - Використати `onComplete` для завершення руху

**Пояснення Tween.js:**
```typescript
import * as TWEEN from '@tweenjs/tween.js';

const tween = new TWEEN.Tween({ y: currentY })
  .to({ y: targetY }, duration) // duration в мілісекундах
  .onUpdate((object) => {
    elevatorView.y = object.y; // оновлюємо позицію
  })
  .onComplete(() => {
    // логіка після завершення
  })
  .start();
```

### 4.2 Анімація руху людей
- [ ] `src/controllers/PersonController.ts`:
  - Метод `moveToElevator()` - рух від правої сторони до ліфта
  - Метод `moveFromElevator()` - рух від ліфта до правої сторони
  - Використати Tween для X-координати

**Пояснення:** Люди рухаються горизонтально (X-вісь), ліфт - вертикально (Y-вісь)

### 4.3 Game Loop для Tween.js
- [ ] У `src/main.ts`:
  - Створити функцію `animate()` з `requestAnimationFrame`
  - Викликати `TWEEN.update()` в кожному кадрі
  - Викликати `app.renderer.render(app.stage)`

**Пояснення:** Tween.js потребує оновлення в кожному кадрі анімації

**Git коміт:** "Add Tween.js animations for elevator and people movement"

---

## Етап 5: Логіка генерації людей (День 4, 2-3 години)

### 5.1 Система спавну людей
- [ ] `src/controllers/PersonSpawner.ts`:
  - Метод `startSpawning()`:
    - Для кожного поверху створити інтервал
    - Інтервал: рандомно 4-10 секунд
    - При спрацюванні: створити нову людину з рандомним targetFloor
  - Метод `stopSpawning()` - зупинити генерацію

**Пояснення:** `setInterval` або `setTimeout` з рекурсією для рандомних інтервалів

### 5.2 Інтеграція з моделлю
- [ ] Підключити PersonSpawner до Building
- [ ] При створенні людини додати її до waitingPeople відповідного поверху
- [ ] Створити PersonView для кожної нової людини

**Git коміт:** "Add random person spawning system"

---

## Етап 6: Логіка роботи ліфта (День 4-5, 6-8 годин)

### 6.1 Базова логіка руху ліфта
- [ ] `src/controllers/ElevatorController.ts`:
  - Метод `process()` - основний цикл обробки:
    1. Перевірити чи є люди, що чекають
    2. Визначити напрямок руху
    3. Знайти найближчий поверх з людьми
    4. Рухатися до нього
    5. Зупинитися на 800мс для завантаження
    6. Підібрати людей
    7. Рухатися до цільових поверхів
    8. Випустити людей

**Пояснення:** Це state machine зі станами: IDLE, MOVING_UP, MOVING_DOWN, LOADING, UNLOADING

### 6.2 Обробка завантаження/вивантаження
- [ ] Метод `loadPassengers(floor)`:
  - Знайти всіх людей на поверсі з правильним напрямком
  - Перевірити місткість ліфта
  - Додати до ліфта
  - Запустити анімацію входу в ліфт
- [ ] Метод `unloadPassengers(floor)`:
  - Знайти пасажирів, яким потрібен цей поверх
  - Видалити з ліфта
  - Запустити анімацію виходу з ліфта

### 6.3 Обробка зупинки (800мс)
- [ ] Використати Promise або callback після завершення Tween
- [ ] Додати затримку 800мс перед завантаженням
- [ ] Після завантаження - затримка перед рухом

**Git коміт:** "Implement elevator movement and passenger loading logic"

---

## Етап 7: Оптимізація (Бонус) (День 5-6, 3-4 години)

### 7.1 Розумна логіка руху
- [ ] Метод `getNextDestination()`:
  - Якщо ліфт порожній: знайти найближчий поверх з людьми
  - Якщо є пасажири: знайти найближчий цільовий поверх
  - Якщо є пасажири + люди чекають: визначити оптимальний порядок
- [ ] Пропускати поверхи без людей та без пасажирів, що виходять

**Пояснення:** Алгоритм схожий на SCAN (elevator algorithm) - ліфт рухається в одному напрямку, збираючи всіх по дорозі

### 7.2 Оптимізація маршруту
- [ ] Сортувати пасажирів за напрямком та поверхом
- [ ] Групувати зупинки по напрямку
- [ ] Не зупинятися на поверхах, де немає ні пасажирів, ні людей, що чекають

**Git коміт:** "Add elevator optimization: skip empty floors"

---

## Етап 8: Конфігурація та UI (День 6, 2-3 години)

### 8.1 Конфігураційний файл
- [ ] `src/config/config.ts`:
  - Експортувати BuildingConfig з налаштуваннями
  - Валідація: floors (4-10), capacity (2-4)

### 8.2 Простий UI для зміни конфігурації
- [ ] Додати HTML input для кількості поверхів
- [ ] Додати HTML input для місткісті ліфта
- [ ] Кнопка "Restart" для перезапуску з новими параметрами

**Git коміт:** "Add configuration UI and validation"

---

## Етап 9: Полірування та тестування (День 7, 4-6 годин)

### 9.1 Виправлення багів
- [ ] Перевірити всі edge cases:
  - Ліфт на останньому/першому поверсі
  - Всі люди вийшли, нові не з'явилися
  - Ліфт заповнений, люди чекають
  - Одночасний спавн багатьох людей

### 9.2 Покращення візуалізації
- [ ] Додати індикатор напрямку ліфта (стрілка)
- [ ] Покращити відображення людей в ліфті
- [ ] Додати плавні переходи кольорів

### 9.3 Оптимізація продуктивності
- [ ] Перевірити FPS (має бути 60)
- [ ] Видалити невикористані об'єкти (люди, що вийшли)
- [ ] Оптимізувати рендеринг (використати PIXI cache)

**Git коміт:** "Polish: bug fixes and performance optimization"

---

## Етап 10: Фіналізація (День 7, 1-2 години)

### 10.1 Рефакторинг
- [ ] Перевірити чи код відповідає SOLID принципам
- [ ] Видалити закоментований код
- [ ] Додати коментарі до складних місць

### 10.2 README
- [ ] Створити README.md з інструкціями запуску
- [ ] Описати структуру проекту
- [ ] Додати скріншоти/опис функціоналу

### 10.3 Фінальний git
- [ ] Перевірити що всі коміти логічні та описові
- [ ] Перевірити що немає великих файлів
- [ ] Створити .gitignore (node_modules, dist, тощо)

**Git коміт:** "Final cleanup and documentation"

---

## Корисні ресурси для навчання

### PIXI.js:
- Офіційна документація: https://pixijs.com/
- Основні концепції: Application, Container, Graphics, Text, Sprite
- Важливо: координати (0,0) - верхній лівий кут, Y збільшується вниз

### Tween.js:
- Офіційна документація: https://github.com/tweenjs/tween.js/
- Основні методи: `to()`, `start()`, `stop()`, `update()`
- Easing функції для плавності (optional)

### TypeScript:
- Використовуйте інтерфейси для типізації
- Enum для констант (Direction)
- Generics для універсальних класів (опціонально)

---

## Поради по виконанню

1. **Починайте з простого**: спочатку зробіть статичну візуалізацію, потім додавайте анімацію
2. **Тестуйте поступово**: після кожного етапу перевіряйте що все працює
3. **Використовуйте console.log**: для дебагу станів ліфта та людей
4. **Не бійтеся переписувати**: якщо щось не працює, краще переписати частину коду
5. **Git коміти**: робіть коміти після кожного завершеного етапу
6. **Питання**: якщо щось незрозуміло - запитуйте, краще запитати ніж робити неправильно

---

## Очікуваний результат

- Працюючий симулятор ліфта з візуалізацією
- Люди з'являються та рухаються
- Ліфт перевозить людей з дотриманням правил
- Оптимізація роботи ліфта (бонус)
- Чистий TypeScript код з хорошою структурою
- Кілька логічних git комітів
